<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Minimalist Timer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for circular progress */
        .circle-progress {
            transform: rotate(-90deg);
            transition: stroke-dashoffset 0.1s linear;
        }
        
        /* Hide spin buttons in number inputs */
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }

        /* Fullscreen styles */
        :fullscreen {
            background: var(--bg-color);
        }
        
        /* System theme variables */
        :root {
            --bg-color: white;
            --text-color: black;
        }
        
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-color: rgb(17, 24, 39);
                --text-color: white;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-white dark:bg-gray-900 text-gray-900 dark:text-white flex items-center justify-center transition-colors">
    <div id="app" class="w-full max-w-4xl p-8">
        <!-- Mode Toggle -->
        <div class="flex justify-center mb-8">
            <div class="inline-flex rounded-lg border border-gray-300 dark:border-gray-600 overflow-hidden">
                <button id="countdownMode" class="px-6 py-2 bg-blue-500 text-white transition-colors">
                    Countdown
                </button>
                <button id="stopwatchMode" class="px-6 py-2 bg-transparent dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors">
                    Stopwatch
                </button>
            </div>
        </div>

        <!-- Timer Display with Circle Progress -->
        <div class="relative flex justify-center items-center mb-12">
            <svg class="absolute w-80 h-80" viewBox="0 0 200 200">
                <circle
                    cx="100"
                    cy="100"
                    r="90"
                    stroke="currentColor"
                    stroke-width="2"
                    fill="none"
                    class="text-gray-200 dark:text-gray-700"
                />
                <circle
                    id="progressCircle"
                    cx="100"
                    cy="100"
                    r="90"
                    stroke="currentColor"
                    stroke-width="4"
                    fill="none"
                    class="circle-progress text-blue-500"
                    stroke-dasharray="565.48"
                    stroke-dashoffset="565.48"
                    stroke-linecap="round"
                />
            </svg>
            <div class="relative z-10 text-center">
                <div id="display" class="text-6xl md:text-7xl font-mono font-light tabular-nums">
                    00:00:00.000
                </div>
            </div>
        </div>

        <!-- Time Input (for countdown) -->
        <div id="timeInput" class="flex justify-center gap-2 mb-8">
            <div class="flex items-center gap-2">
                <input type="number" id="hours" min="0" max="99" value="0" 
                    class="w-16 text-2xl text-center bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:outline-none">
                <span class="text-xl">h</span>
            </div>
            <div class="flex items-center gap-2">
                <input type="number" id="minutes" min="0" max="59" value="1" 
                    class="w-16 text-2xl text-center bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:outline-none">
                <span class="text-xl">m</span>
            </div>
            <div class="flex items-center gap-2">
                <input type="number" id="seconds" min="0" max="59" value="0" 
                    class="w-16 text-2xl text-center bg-transparent border-b-2 border-gray-300 dark:border-gray-600 focus:border-blue-500 focus:outline-none">
                <span class="text-xl">s</span>
            </div>
        </div>

        <!-- Control Buttons -->
        <div class="flex justify-center gap-4 mb-8">
            <button id="startBtn" 
                class="px-8 py-3 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors font-medium">
                Start (Space)
            </button>
            <button id="pauseBtn" 
                class="px-8 py-3 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg transition-colors font-medium hidden">
                Pause (Space)
            </button>
            <button id="resumeBtn" 
                class="px-8 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors font-medium hidden">
                Resume (Space)
            </button>
            <button id="resetBtn" 
                class="px-8 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors font-medium">
                Reset (R)
            </button>
            <button id="fullscreenBtn" 
                class="px-8 py-3 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors font-medium">
                Fullscreen (F)
            </button>
        </div>

        <!-- Keyboard Shortcuts Help -->
        <div class="text-center text-sm text-gray-500 dark:text-gray-400">
            <p>Keyboard: Space = Start/Pause/Resume | R = Reset | F = Fullscreen | Tab = Switch Mode</p>
        </div>
    </div>

    <!-- Audio for notification -->
    <audio id="alarmSound" preload="auto">
        <source src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBin+8Oy9Uy0OMpba6bruKBQwjtvj0NHIuuLt0LHIuLvsvHV8eJB6g359hIR+e3dvWmhhdWdWVWRVWEpMSVdaV1RQU0xFRUZEU0pEQkRCRkNAP0FFSEVNRkdJUk1STFdQUVFUWVVWYVxgYmRhZGNkaXJzeHh3fHx5fIGBfXh+j4aDfYqFhIaJgIeHg4uLg4mTkYuTlJGTnJSVlJmMmZealZ2fjpOhlYmRkp6OhaKYop2OpaOdnqavp62xpbKy" type="audio/wav">
    </audio>

    <script>
        // Timer state
        let mode = 'countdown'; // 'countdown' or 'stopwatch'
        let isRunning = false;
        let isPaused = false;
        let startTime = 0;
        let elapsedTime = 0;
        let totalTime = 0; // for countdown
        let interval = null;

        // DOM elements
        const display = document.getElementById('display');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const resumeBtn = document.getElementById('resumeBtn');
        const resetBtn = document.getElementById('resetBtn');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const countdownModeBtn = document.getElementById('countdownMode');
        const stopwatchModeBtn = document.getElementById('stopwatchMode');
        const timeInputDiv = document.getElementById('timeInput');
        const hoursInput = document.getElementById('hours');
        const minutesInput = document.getElementById('minutes');
        const secondsInput = document.getElementById('seconds');
        const progressCircle = document.getElementById('progressCircle');
        const alarmSound = document.getElementById('alarmSound');

        // Format time display
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            const milliseconds = ms % 1000;
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}.${milliseconds.toString().padStart(3, '0')}`;
        }

        // Update display and progress
        function updateDisplay() {
            if (mode === 'countdown') {
                const remainingTime = Math.max(0, totalTime - elapsedTime);
                display.textContent = formatTime(remainingTime);
                
                // Update circular progress
                const progress = totalTime > 0 ? (elapsedTime / totalTime) : 0;
                const circumference = 565.48; // 2 * Math.PI * 90
                progressCircle.style.strokeDashoffset = circumference * (1 - progress);
                
                // Check if countdown finished
                if (remainingTime === 0 && isRunning) {
                    stop();
                    alarmSound.play();
                    // Flash animation
                    display.classList.add('animate-pulse');
                    setTimeout(() => display.classList.remove('animate-pulse'), 3000);
                }
            } else {
                display.textContent = formatTime(elapsedTime);
                
                // Continuous rotation for stopwatch
                const progress = (elapsedTime % 60000) / 60000;
                const circumference = 565.48;
                progressCircle.style.strokeDashoffset = circumference * (1 - progress);
            }
        }

        // Timer functions
        function start() {
            if (mode === 'countdown') {
                const hours = parseInt(hoursInput.value) || 0;
                const minutes = parseInt(minutesInput.value) || 0;
                const seconds = parseInt(secondsInput.value) || 0;
                totalTime = (hours * 3600 + minutes * 60 + seconds) * 1000;
                
                if (totalTime === 0) {
                    alert('Please set a time for countdown');
                    return;
                }
            }
            
            isRunning = true;
            isPaused = false;
            startTime = Date.now() - elapsedTime;
            
            interval = setInterval(() => {
                elapsedTime = Date.now() - startTime;
                updateDisplay();
            }, 10);
            
            startBtn.classList.add('hidden');
            pauseBtn.classList.remove('hidden');
            if (mode === 'countdown') {
                timeInputDiv.classList.add('opacity-50', 'pointer-events-none');
            }
        }

        function pause() {
            isRunning = false;
            isPaused = true;
            clearInterval(interval);
            
            pauseBtn.classList.add('hidden');
            resumeBtn.classList.remove('hidden');
        }

        function resume() {
            isRunning = true;
            isPaused = false;
            startTime = Date.now() - elapsedTime;
            
            interval = setInterval(() => {
                elapsedTime = Date.now() - startTime;
                updateDisplay();
            }, 10);
            
            resumeBtn.classList.add('hidden');
            pauseBtn.classList.remove('hidden');
        }

        function stop() {
            isRunning = false;
            isPaused = false;
            clearInterval(interval);
            
            pauseBtn.classList.add('hidden');
            resumeBtn.classList.add('hidden');
            startBtn.classList.remove('hidden');
        }

        function reset() {
            stop();
            elapsedTime = 0;
            updateDisplay();
            progressCircle.style.strokeDashoffset = '565.48';
            if (mode === 'countdown') {
                timeInputDiv.classList.remove('opacity-50', 'pointer-events-none');
            }
        }

        // Mode switching
        function switchToCountdown() {
            if (isRunning) {
                if (!confirm('Switching modes will reset the timer. Continue?')) return;
            }
            reset();
            mode = 'countdown';
            countdownModeBtn.classList.add('bg-blue-500', 'text-white');
            countdownModeBtn.classList.remove('bg-transparent', 'dark:text-gray-300');
            stopwatchModeBtn.classList.remove('bg-blue-500', 'text-white');
            stopwatchModeBtn.classList.add('bg-transparent', 'dark:text-gray-300');
            timeInputDiv.classList.remove('hidden');
        }

        function switchToStopwatch() {
            if (isRunning) {
                if (!confirm('Switching modes will reset the timer. Continue?')) return;
            }
            reset();
            mode = 'stopwatch';
            stopwatchModeBtn.classList.add('bg-blue-500', 'text-white');
            stopwatchModeBtn.classList.remove('bg-transparent', 'dark:text-gray-300');
            countdownModeBtn.classList.remove('bg-blue-500', 'text-white');
            countdownModeBtn.classList.add('bg-transparent', 'dark:text-gray-300');
            timeInputDiv.classList.add('hidden');
        }

        // Fullscreen
        function toggleFullscreen() {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen();
            } else {
                document.exitFullscreen();
            }
        }

        // Event listeners
        startBtn.addEventListener('click', start);
        pauseBtn.addEventListener('click', pause);
        resumeBtn.addEventListener('click', resume);
        resetBtn.addEventListener('click', reset);
        fullscreenBtn.addEventListener('click', toggleFullscreen);
        countdownModeBtn.addEventListener('click', switchToCountdown);
        stopwatchModeBtn.addEventListener('click', switchToStopwatch);

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                if (!isRunning && !isPaused) {
                    start();
                } else if (isRunning) {
                    pause();
                } else if (isPaused) {
                    resume();
                }
            } else if (e.key.toLowerCase() === 'r') {
                reset();
            } else if (e.key.toLowerCase() === 'f') {
                toggleFullscreen();
            } else if (e.key === 'Tab') {
                e.preventDefault();
                if (mode === 'countdown') {
                    switchToStopwatch();
                } else {
                    switchToCountdown();
                }
            }
        });

        // Input validation
        hoursInput.addEventListener('input', (e) => {
            if (e.target.value > 99) e.target.value = 99;
            if (e.target.value < 0) e.target.value = 0;
        });

        minutesInput.addEventListener('input', (e) => {
            if (e.target.value > 59) e.target.value = 59;
            if (e.target.value < 0) e.target.value = 0;
        });

        secondsInput.addEventListener('input', (e) => {
            if (e.target.value > 59) e.target.value = 59;
            if (e.target.value < 0) e.target.value = 0;
        });

        // Initialize
        updateDisplay();
    </script>
</body>
</html>
